<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TradePiGloball · B2B Marketplace</title>

  <style>
    :root{
      --bg0:#070813;
      --bg1:#090a18;
      --text:#e9e9ef;
      --muted:rgba(233,233,239,.75);

      /* Kart rengi (SENİN İSTEDİĞİN RENK DİLİ) */
      --glass: rgba(110, 40, 140, 0.30);
      --glass2: rgba(255,255,255,0.06);
      --stroke: rgba(255,255,255,0.10);

      --primaryA:#b44cff;
      --primaryB:#ff5fd8;
      --chip: rgba(255,255,255,0.08);

      --shadow: 0 14px 40px rgba(0,0,0,.45);
      --r: 18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);

      /* ✅ SADECE ARKA PLAN DEĞİŞTİ (kartlar aynı vibe) */
      background:
        radial-gradient(1100px 650px at 15% -10%, rgba(180,76,255,.18), transparent 60%),
        radial-gradient(900px 600px at 85% 10%, rgba(255,95,216,.12), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 55%, #060612 100%);
      min-height:100vh;
    }

    a{color:inherit; text-decoration:none}
    .wrap{max-width:1180px; margin:0 auto; padding:22px 16px 80px;}

    /* ===== TOP BAR ===== */
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding:10px 2px 18px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:800; letter-spacing:.3px;
    }
    .logo{
      width:34px; height:34px; border-radius:10px;
      background: linear-gradient(135deg, rgba(180,76,255,.95), rgba(255,95,216,.85));
      box-shadow: 0 10px 30px rgba(180,76,255,.25);
    }
    .brand small{display:block; font-weight:600; opacity:.85; margin-top:1px}

    .top-actions{display:flex; gap:10px; align-items:center}
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      height:42px; padding:0 14px; border-radius:14px;
      border:1px solid transparent;
      font-weight:700; letter-spacing:.2px;
      cursor:pointer; user-select:none;
      transition:transform .12s ease, box-shadow .12s ease, background .12s ease;
      white-space:nowrap;
    }
    .btn:active{transform:translateY(1px)}
    .btn-primary{
      background: linear-gradient(135deg, var(--primaryA), var(--primaryB));
      box-shadow: 0 12px 34px rgba(180,76,255,.28);
      border:none;
      color:#fff;
    }
    .btn-primary:hover{box-shadow: 0 16px 44px rgba(180,76,255,.36)}
    .btn-secondary{
      background: rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.12);
      color:var(--text);
      backdrop-filter: blur(10px);
    }
    .btn-secondary:hover{background: rgba(255,255,255,0.10)}
    .btn-ghost{
      background:transparent;
      border:1px solid rgba(196,181,253,.35);
      color:#c4b5fd;
    }
    .btn-ghost:hover{background: rgba(196,181,253,.08)}

    /* ===== HERO ===== */
    .hero{
      margin-top:8px;
      padding:18px;
      border-radius: calc(var(--r) + 8px);
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015));
      border:1px solid rgba(255,255,255,0.06);
    }
    .hero-inner{
      display:grid;
      grid-template-columns: 1.2fr 0.8fr;
      gap:16px;
    }
    @media (max-width: 920px){
      .hero-inner{grid-template-columns:1fr}
    }

    .hero-left{
      padding:18px;
      border-radius: var(--r);
    }
    .hero h1{
      margin:0 0 10px;
      font-size: clamp(26px, 3.2vw, 44px);
      line-height:1.05;
      letter-spacing:-0.4px;
    }
    .hero p{
      margin:0 0 16px;
      color:var(--muted);
      font-size: 15.5px;
      line-height:1.5;
      max-width: 56ch;
    }
    .hero-ctas{display:flex; flex-wrap:wrap; gap:10px}

    /* ✅ SENİN İSTEDİĞİN KART RENGİ KALDI */
    .hero-card{
      padding:18px;
      border-radius: var(--r);
      background: var(--glass);
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(18px);
      display:flex; flex-direction:column; gap:12px;
      min-height: 190px;
    }
    .mini{
      font-weight:800; letter-spacing:.2px;
      font-size:13px; opacity:.9;
    }
    .stats{
      display:grid; grid-template-columns:1fr 1fr;
      gap:10px;
    }
    .stat{
      padding:12px;
      border-radius: 14px;
      background: rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.10);
    }
    .stat b{display:block; font-size:18px}
    .stat span{display:block; font-size:12px; opacity:.75; margin-top:2px}

    /* ===== SECTORS ===== */
    .section{
      margin-top:22px;
    }
    .section-title{
      display:flex; align-items:flex-end; justify-content:space-between;
      gap:10px;
      margin: 0 0 10px;
      padding: 0 4px;
    }
    .section-title h2{
      margin:0;
      font-size: 16px;
      letter-spacing:.2px;
      opacity:.95;
    }
    .hint{
      font-size:12px; color:rgba(233,233,239,.65);
    }
    .sector-row{
      display:flex; gap:10px;
      overflow:auto;
      padding: 8px 4px 2px;
      scroll-snap-type: x mandatory;
    }
    .sector-row::-webkit-scrollbar{height:8px}
    .sector-row::-webkit-scrollbar-thumb{background:rgba(255,255,255,.12); border-radius:999px}
    .chip{
      scroll-snap-align:start;
      padding:10px 12px;
      border-radius: 999px;
      background: var(--chip);
      border:1px solid rgba(255,255,255,0.10);
      color: rgba(233,233,239,.88);
      font-weight:700;
      font-size: 13px;
      white-space:nowrap;
      cursor:pointer;
      transition: background .12s ease, transform .12s ease;
    }
    .chip:hover{background: rgba(255,255,255,0.12)}
    .chip.active{
      background: rgba(180,76,255,0.22);
      border-color: rgba(180,76,255,0.35);
      color:#fff;
    }

    /* ===== COMPANY GRID ===== */
    .grid{
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap: 14px;
      padding: 4px;
    }
    @media (max-width: 1050px){ .grid{grid-template-columns: repeat(3,1fr)} }
    @media (max-width: 760px){ .grid{grid-template-columns: repeat(2,1fr)} }
    @media (max-width: 420px){ .grid{grid-template-columns: 1fr} }

    .card{
      border-radius: var(--r);
      background: var(--glass2);
      border:1px solid rgba(255,255,255,0.10);
      box-shadow: 0 12px 28px rgba(0,0,0,.30);
      overflow:hidden;
      position:relative;
      cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
    }
    .card:hover{
      transform: translateY(-2px);
      border-color: rgba(255,255,255,0.16);
      box-shadow: 0 16px 40px rgba(0,0,0,.42);
    }

    .thumb{
      height: 110px;
      background:
        radial-gradient(240px 90px at 30% 20%, rgba(180,76,255,.35), transparent 65%),
        radial-gradient(240px 120px at 80% 0%, rgba(255,95,216,.22), transparent 60%),
        linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border-bottom:1px solid rgba(255,255,255,0.08);
    }
    .card-body{padding:12px}
    .name{font-weight:900; letter-spacing:.1px; margin:0 0 6px; font-size:14.5px}
    .meta{margin:0; font-size:12.5px; color:rgba(233,233,239,.72); line-height:1.3}
    .tag{
      display:inline-flex;
      margin-top:10px;
      padding:7px 10px;
      border-radius:999px;
      background: rgba(180,76,255,0.12);
      border:1px solid rgba(180,76,255,0.20);
      font-size:12px;
      font-weight:800;
      color:#eeddff;
    }

    .card-cta{
      position:absolute;
      right:10px; bottom:10px;
      padding:8px 10px;
      border-radius: 12px;
      background: rgba(0,0,0,0.28);
      border:1px solid rgba(255,255,255,0.12);
      font-size:12px;
      font-weight:800;
      opacity:0;
      transform: translateY(3px);
      transition: opacity .12s ease, transform .12s ease;
      backdrop-filter: blur(8px);
    }
    .card:hover .card-cta{opacity:1; transform: translateY(0)}

    /* ===== FOOTER ===== */
    footer{
      margin-top:26px;
      padding:18px 6px 0;
      color: rgba(233,233,239,.55);
      font-size: 12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      justify-content:space-between;
      border-top:1px solid rgba(255,255,255,0.06);
    }
    .links{display:flex; gap:12px; flex-wrap:wrap}
    .links a{opacity:.75}
    .links a:hover{opacity:1}
  </style>
</head>

<body>
  <div class="wrap">

    <!-- TOP BAR -->
    <div class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          TradePiGloball
          <small>B2B Marketplace</small>
        </div>
      </div>

      <div class="top-actions">
        <a class="btn btn-secondary" href="/login">Giriş Yap</a>
        <a class="btn btn-primary" href="/signup">Üye Ol</a>
      </div>
    </div>

    <!-- HERO -->
    <section class="hero">
      <div class="hero-inner">

        <div class="hero-left">
          <h1>Global B2B ticaret, tek platformda.</h1>
          <p>
            Firmaları keşfet. 3D showroom deneyimiyle ürünleri daha net gör.
            RFQ ile hızlı teklif topla.
          </p>

          <div class="hero-ctas">
            <a class="btn btn-primary" href="/expo">Dijital Expo’ya Gir</a>
            <a class="btn btn-secondary" href="/rfq">RFQ Oluştur</a>
            <a class="btn btn-ghost" href="/plans">Paketleri İncele</a>
          </div>
        </div>

        <!-- ✅ Kart rengi kalsın: burada -->
        <aside class="hero-card">
          <div class="mini">Öne Çıkanlar</div>
          <div class="stats">
            <div class="stat"><b>3D</b><span>Showroom deneyimi</span></div>
            <div class="stat"><b>RFQ</b><span>Hızlı teklif akışı</span></div>
            <div class="stat"><b>TL / USD</b><span>Çoklu para birimi</span></div>
            <div class="stat"><b>Kurumsal</b><span>Firma odaklı yapı</span></div>
          </div>
        </aside>

      </div>
    </section>

    <!-- SECTORS -->
    <section class="section">
      <div class="section-title">
        <h2>Sektörler</h2>
        <div class="hint">Kaydır · Seç · Filtrele</div>
      </div>
      <div class="sector-row" id="sectorRow"></div>
    </section>

    <!-- COMPANY GRID -->
    <section class="section">
      <div class="section-title">
        <h2>Firmalar</h2>
        <div class="hint" id="gridHint">Yeni eklenenler</div>
      </div>

      <div class="grid" id="companyGrid"></div>
    </section>

    <!-- FOOTER -->
    <footer>
      <div>© 2025 TradePiGloball</div>
      <div class="links">
        <a href="/terms">Kullanım Şartları</a>
        <a href="/privacy">Gizlilik</a>
        <a href="/kvkk">KVKK</a>
        <a href="/contact">İletişim</a>
      </div>
    </footer>

  </div>

  <script>
    // --- helpers
    const qs = (k) => new URLSearchParams(location.search).get(k) || "";
    const setQS = (k, v) => {
      const p = new URLSearchParams(location.search);
      if (!v) p.delete(k); else p.set(k, v);
      history.replaceState(null, "", location.pathname + "?" + p.toString());
    };

    const sectorRow = document.getElementById("sectorRow");
    const grid = document.getElementById("companyGrid");
    const gridHint = document.getElementById("gridHint");

    let activeSector = qs("sector");

    // --- render sectors
    async function loadSectors(){
      sectorRow.innerHTML = "";
      const res = await fetch("/api/sectors");
      const json = await res.json();
      const sectors = json.sectors || [];

      // "Tümü" chip
      const all = document.createElement("button");
      all.className = "chip" + (!activeSector ? " active" : "");
      all.textContent = "Tümü";
      all.onclick = () => {
        activeSector = "";
        setQS("sector", "");
        paintActiveChips();
        loadCompanies();
      };
      sectorRow.appendChild(all);

      sectors.forEach(name => {
        const b = document.createElement("button");
        b.className = "chip" + (activeSector === name ? " active" : "");
        b.textContent = name;
        b.onclick = () => {
          activeSector = name;
          setQS("sector", name);
          paintActiveChips();
          loadCompanies();
        };
        sectorRow.appendChild(b);
      });
    }

    function paintActiveChips(){
      [...sectorRow.querySelectorAll(".chip")].forEach(ch => {
        const txt = ch.textContent;
        if (!activeSector && txt === "Tümü") ch.classList.add("active");
        else if (activeSector && txt === activeSector) ch.classList.add("active");
        else ch.classList.remove("active");
      });
    }

    // --- render companies
    function cardHTML(c){
      const loc = [c.country, c.city].filter(Boolean).join(" · ");
      const sector = c.sector || "Sektör";
      return `
        <div class="card" data-slug="${c.slug}">
          <div class="thumb"></div>
          <div class="card-body">
            <p class="name">${escapeHTML(c.name || "Firma")}</p>
            <p class="meta">${escapeHTML(sector)}${loc ? " · " + escapeHTML(loc) : ""}</p>
            <div class="tag">3D Showroom</div>
          </div>
          <div class="card-cta">Expo’ya Gir</div>
        </div>
      `;
    }

    async function loadCompanies(){
      grid.innerHTML = "";
      gridHint.textContent = activeSector ? ("Filtre: " + activeSector) : "Yeni eklenenler";

      const url = new URL(location.origin + "/api/companies");
      url.searchParams.set("limit", "12");
      if (activeSector) url.searchParams.set("sector", activeSector);

      const res = await fetch(url.pathname + url.search);
      const json = await res.json();
      const companies = json.companies || [];

      if (!companies.length){
        grid.innerHTML = `<div style="padding:14px;opacity:.75">Bu filtrede firma yok.</div>`;
        return;
      }

      grid.innerHTML = companies.map(cardHTML).join("");

      // click → /expo/:slug
      [...grid.querySelectorAll(".card")].forEach(el => {
        el.addEventListener("click", () => {
          const slug = el.getAttribute("data-slug");
          if (slug) location.href = "/expo/" + slug;
        });
      });
    }

    // basic XSS guard for strings we inject
    function escapeHTML(str){
      return String(str).replace(/[&<>"']/g, s => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[s]));
    }

    // boot
    (async function init(){
      try{
        await loadSectors();
        await loadCompanies();
      }catch(e){
        console.error(e);
        grid.innerHTML = `<div style="padding:14px;opacity:.75">Şu an içerik yüklenemedi.</div>`;
      }
    })();
  </script>
</body>
</html>
