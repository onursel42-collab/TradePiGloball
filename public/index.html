<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TradePiGlobal</title>
  <style>
    body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;background:#eef2f7;color:#111}
    header{padding:14px 18px;background:#fff;display:flex;align-items:center;gap:12px;position:sticky;top:0;border-bottom:1px solid #e7eaf0}
    .logo{width:34px;height:34px;border-radius:10px;background:#ff7a18;display:grid;place-items:center;color:#fff;font-weight:800}
    .nav{display:flex;gap:14px;flex:1;justify-content:center;color:#444;font-size:14px}
    .nav a{color:#444;text-decoration:none}
    .actions{display:flex;gap:10px;align-items:center}
    .btn{border:0;border-radius:10px;padding:10px 12px;font-weight:700;cursor:pointer}
    .btn.primary{background:#111;color:#fff}
    .btn.ghost{background:#eef2f7;color:#111}
    main{padding:18px;max-width:1100px;margin:0 auto}
    .hero{display:grid;grid-template-columns:1.2fr .8fr;gap:14px;align-items:stretch}
    .panel{background:#fff;border-radius:16px;padding:16px;box-shadow:0 8px 26px rgba(0,0,0,.08)}
    .title{font-size:26px;font-weight:900;margin:6px 0}
    .muted{opacity:.75}
    .chips{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
    .chip{padding:10px 12px;border-radius:999px;background:#111;color:#fff;font-size:13px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:14px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:14px;margin-top:14px}
    .card{background:#111;border-radius:16px;color:#fff;padding:14px;box-shadow:0 18px 40px rgba(0,0,0,.22)}
    .card.light{background:#fff;color:#111;box-shadow:0 8px 26px rgba(0,0,0,.08)}
    input, textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #e3e7ef;font-size:14px}
    textarea{min-height:90px;resize:vertical}
    .small{font-size:13px}
  </style>
</head>
<body>

<header>
  <div class="logo">TPG</div>
  <div class="nav">
    <a href="#marketplace">Marketplace</a>
    <a href="#rfq">RFQ / Teklif</a>
    <a href="#expo">Dijital Expo</a>
    <a href="#plans">Paketler</a>
  </div>
  <div class="actions">
    <button class="btn ghost" onclick="alert('Login sonra bağlayacağız')">Giriş Yap</button>
    <button class="btn primary" onclick="alert('Üyelik sonra bağlayacağız')">Üye Ol</button>
  </div>
</header>

<main>
  <section class="hero">
    <div class="panel">
      <div class="muted small">B2B TİCARET & DİJİTAL FUAR ALTYAPISI</div>
      <div class="title">Global B2B ticaret ve dijital fuar tek platformda.</div>
      <div class="muted">Üreticiler, distribütörler ve kurumsal alıcılar için etkileşimli B2B ticaret ve dijital vitrin altyapısı.</div>

      <div style="display:flex;gap:10px;margin-top:14px;flex-wrap:wrap">
        <button class="btn primary" onclick="document.getElementById('rfq').scrollIntoView({behavior:'smooth'})">RFQ Oluştur</button>
        <button class="btn ghost" onclick="document.getElementById('expo').scrollIntoView({behavior:'smooth'})">Dijital Expo’ya Gir</button>
      </div>

      <div style="margin-top:14px" class="muted small">
        ✔ Onaylı firma profilleri & ürün vitrinleri <br/>
        ✔ RFQ → teklif akışı <br/>
        ✔ Dijital fuar & showroom alanları
      </div>
    </div>

    <div class="panel">
      <div style="font-weight:800;margin-bottom:10px">Platform özeti</div>
      <div class="muted small">
        - Çoklu para birimi (TL/USD/Pi)<br/>
        - Paket bazlı ürün limiti<br/>
        - Expo sayfaları: /expo/:slug<br/>
        - API: /api/expo/:slug
      </div>
      <div style="margin-top:12px">
        <input id="goSlug" placeholder="Expo için firma slug (örn: tradepigloball)" />
        <button class="btn primary" style="margin-top:10px;width:100%" onclick="goExpo()">Expo’ya Git</button>
      </div>
    </div>
  </section>

  <section id="marketplace" style="margin-top:18px">
    <div class="panel">
      <div style="font-weight:900;margin-bottom:10px">Sektörlere göre B2B marketplace</div>
      <div class="muted small">Şimdilik sektör filtreleri hazır; marketplace liste ekranını sonra bağlarız.</div>
      <div class="chips" id="sectors"></div>
    </div>
  </section>

  <section id="rfq" style="margin-top:14px" class="row">
    <div class="card">
      <div style="font-weight:900;font-size:18px">RFQ & Teklif akışı</div>
      <div class="muted small" style="margin-top:6px">
        Tek tıkla teklif iste: Miktar, teslimat, hedef fiyat… satıcılar teklifini göndersin.
      </div>

      <div style="margin-top:12px">
        <input id="buyer_name" placeholder="Ad Soyad" />
        <input id="buyer_email" placeholder="E-posta" style="margin-top:10px" />
        <input id="sector" placeholder="Sektör" style="margin-top:10px" />
        <input id="country" placeholder="Ülke" style="margin-top:10px" />
        <input id="city" placeholder="Şehir" style="margin-top:10px" />
        <textarea id="message" placeholder="RFQ mesajı (ne arıyorsun?)" style="margin-top:10px"></textarea>
        <button class="btn primary" style="margin-top:10px;width:100%" onclick="sendRFQ()">RFQ Gönder</button>
        <div id="rfqResult" class="muted small" style="margin-top:8px"></div>
      </div>
    </div>

    <div class="card" style="background:linear-gradient(135deg,#ff7a18,#af002d 70%,#319197);">
      <div style="font-weight:900;font-size:18px">3D DIGITAL EXPO PREVIEW</div>
      <div class="muted small" style="margin-top:6px;color:#fff">
        Expo sayfasında Babylon sahnesi render oluyor. Şu an showroom preview aktif.
      </div>
      <button class="btn ghost" style="margin-top:12px" onclick="goExpo()">Dijital Expo’ya Gir</button>
    </div>
  </section>

  <section id="plans" style="margin-top:14px">
    <div class="panel">
      <div style="font-weight:900;margin-bottom:6px">Satıcı üyelik paketleri</div>
      <div class="muted small">Paketler Supabase’den geliyor: membership_plans</div>
      <div class="grid" id="plansGrid"></div>
    </div>
  </section>

  <div style="height:40px"></div>
</main>

<script>
  function goExpo(){
    const slug = (document.getElementById("goSlug").value || "tradepigloball").trim();
    window.location.href = "/expo/" + encodeURIComponent(slug);
  }

  // sectors
  fetch("/api/sectors").then(r=>r.json()).then(({sectors})=>{
    const el = document.getElementById("sectors");
    el.innerHTML = "";
    (sectors || []).forEach(s=>{
      const d = document.createElement("div");
      d.className = "chip";
      d.innerText = s;
      el.appendChild(d);
    });
  });

  // plans home
  fetch("/api/plans/home").then(r=>r.json()).then(({plans})=>{
    const grid = document.getElementById("plansGrid");
    grid.innerHTML = "";
    (plans || []).forEach(p=>{
      const c = document.createElement("div");
      c.className = "card light";
      c.innerHTML = `
        <div style="font-weight:900;font-size:18px">${p.name}</div>
        <div class="muted small" style="margin-top:6px">Kod: ${p.code}</div>
        <div style="margin-top:10px;font-weight:900">${p.product_limit} ürün limiti</div>
        <div class="muted small" style="margin-top:10px">${p.featured ? "Öne çıkan plan" : ""}</div>
      `;
      grid.appendChild(c);
    });

    if (!plans || !plans.length){
      grid.innerHTML = "<div class='muted'>Plan bulunamadı. membership_plans tablosu boş olabilir.</div>";
    }
  });

  // rfq submit
  function sendRFQ(){
    const payload = {
      buyer_name: document.getElementById("buyer_name").value,
      buyer_email: document.getElementById("buyer_email").value,
      sector: document.getElementById("sector").value,
      country: document.getElementById("country").value,
      city: document.getElementById("city").value,
      message: document.getElementById("message").value,
    };

    fetch("/api/rfq", {
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify(payload)
    })
    .then(r=>r.json())
    .then(d=>{
      document.getElementById("rfqResult").innerText =
        d.ok ? "✅ RFQ kaydedildi (id: " + d.rfq.id + ")" : "❌ Hata: " + (d.error || "bilinmiyor");
    })
    .catch(err=>{
      document.getElementById("rfqResult").innerText = "❌ RFQ gönderilemedi";
      console.error(err);
    });
  }
</script>
</body>
</html>
